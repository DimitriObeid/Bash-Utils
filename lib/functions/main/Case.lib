#!/usr/bin/env bash

# ----------------------
# SCRIPT'S INFORMATIONS

# Name          : Case.lib
# Description   : 
# Author(s)     : Dimitri Obeid
# Version       : 

# DO NOT EXECUTE IT DIRECTLY, instead, just source it by calling the "__BASH_UTILS_MAIN_FUNCTIONS_FILES_PATH" array in the initializer file.

# /////////////////////////////////////////////////////////////////////////////////////////////// #

# Preventing the direct execution of this file, as this script is not meant to be directly executed, but sourced.
if [ "${0##*/}" == "${BASH_SOURCE[0]##*/}" ]; then
    echo -e "WARNING !" >&2; echo >&2
    echo -e "This shell script (${BASH_SOURCE[0]}) is not meant to be executed directly !" >&2
    echo -e "Use this script only by sourcing it in your project script." >&2; echo >&2

    exit 1
fi

# ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; #

#################################### DEFINING LIBRARY FUNCTIONS ###################################

#### LIBRARY RESOURCES

## VARIABLES

__BU_MAIN_CASE_INVALID_ANSWER="Please enter a valid answer ($(DechoHighlight 'yes') or ($(DechoHighlight 'no')) !"

__BU_MAIN_CASE_ASK_CONTINUE_EXEC="Do you want to continue the script's execution ? (yes / no)"

__BU_MAIN_CASE_ANSWER_PROMPT="Enter your answer : "

__BU_MAIN_CASE_RESUME_EXEC="Resuming the execution of the $(DechoHighlight "$__BU_MAIN_PROJECT_NAME") script."

__BU_MAIN_CASE_CANCEL_EXEC="Aborting the $(DechoHighlight "$__BU_MAIN_PROJECT_NAME")'s execution."

# -----------------------------------------------



# /////////////////////////////////////////////////////////////////////////////////////////////// #

#### READING CASE STATEMENTS BY FUNCTIONS

## "Checkings.lib" FILE

# "TriggerRootDirWarning" function.
function CaseRead_TriggerRootDirWarning()
{
    EchoNewstep "$__BU_MAIN_CASE_ASK_CONTINUE_EXEC"
	read -rp "$__BU_MAIN_CASE_ANSWER_PROMPT" __read_TriggerRootDirWarning
	EchoRead "$__read_TriggerRootDirWarning"
	Newline

	# shellcheck disable=SC2154
	case "${__read_TriggerRootDirWarning,,}" in
		"yes")
            EchoNewstep "$__BU_MAIN_CASE_RESUME_EXEC"

			return 0
			;;
		"no")
            EchoError "$__BU_MAIN_CASE_CANCEL_EXEC"

			return 1
			;;
		*)
			EchoError "$__BU_MAIN_CASE_INVALID_ANSWER"
			CaseRead_TriggerRootDirWarning
			;;
	esac
}

# "HandleErrors" function, with the "$__BU_MAIN_STAT_ECHO" variable set to "false".
function CaseRead_HandleErrors()
{
	EchoNewstep "$__BU_MAIN_CASE_ASK_CONTINUE_EXEC"
	read -rp "$__BU_MAIN_CASE_ANSWER_PROMPT" __read_TriggerRootDirWarning
	EchoRead "$__read_TriggerRootDirWarning"
    Newline

	# shellcheck disable=SC2154
	case "${__read_HandleErrors,,}" in
		"yes")
			EchoNewstep "$__BU_MAIN_CASE_RESUME_EXEC"

			return 0
			;;
		"no")
			EchoError "$__BU_MAIN_CASE_CANCEL_EXEC"

			ExitError '1'
			;;
		*)
			EchoError "$__BU_MAIN_CASE_INVALID_ANSWER"
			CaseRead_HandleErrors
			;;
	esac
}
