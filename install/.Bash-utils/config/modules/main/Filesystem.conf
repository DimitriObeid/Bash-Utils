#!/usr/bin/env bash

# Disabling the SC2034 warning from Shellcheck (SC2034: <Variable name> appears unused. Verify use (or export if used externally)), because of the huge number of global variables declared in the configuration files, but only used in the library files.
# shellcheck disable=SC2034

# This configuration file stores every file system-related global variables.

# ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; #

################################## DEFINING RESOURCES - FUNCTIONS #################################

#### OTHER FUNCTIONS

## TEXT PRINTING

# Writing the command substitution text for the file systems description strings.
# shellcheck disable=SC2059
function BU.Main.ModConfig.Filesystem.PrintFSLengthDescription(){ printf "${__BU_MODULE_INIT_MSG__BU_MAIN_MODCONFIG__FILESYSTEM__MAX_LENGHT_STR_MSG}" "${?}"; }

# -----------------------------------------------



# /////////////////////////////////////////////////////////////////////////////////////////////// #

# ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; #

######################################## DEFINING VARIABLES #######################################

#### PROCESSING FILE SYSTEM'S INFORMATIONS

# Getting the file system's name with the "$(df)" command, and parsing the output list according to the operating system's command version.
BU.Main.OS.IsHaiku && __BU_MAIN_FS_NAME="$(df "$0" | awk 'FNR == 4 {print $3}')";
BU.Main.OS.IsLinux && __BU_MAIN_FS_NAME="$(df -Th "$0" | awk 'FNR == 2 {print $2}')";

## EXT2 FILE SYSTEM'S INFORMATIONS

if [ "${__BU_MAIN_FS_NAME,,}" == 'apfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'APFS')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## BTRFS FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'btrfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'Btrfs')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## DRVFS FILE SYSTEM'S INFORMATIONS (WSL FILE SYSTEM)

elif [ "${__BU_MAIN_FS_NAME,,}" == 'drvfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'drvfs')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## EXT2 FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'ext2' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'EXT2')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## EXT3 FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'ext3' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'EXT3')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## EXT4 FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'ext4' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'EXT4')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## JFS FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'jfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'JFS')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## XFS FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'xfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'XFS')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

## ZFS FILE SYSTEM'S INFORMATIONS

elif [ "${__BU_MAIN_FS_NAME,,}" == 'zfs' ]; then
    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "$(BU.Main.ModConfig.Filesystem.PrintFSLengthDescription 'ZFS')" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";

# -----------------------------------------------

else
    # shellcheck disable=SC2059
    BU.Main.Errors.HandleSmallErrors 'W' "$(printf "${__BU_MODULE_INIT_MSG__BU_MAIN_MODCONFIG__FILESYSTEM__UNSUPPORTED_FILESYSTEM}" \
        "${BASH_SOURCE[0]}" "$(( LINENO - 2 ))" "$(BU.Main.Decho.Decho.Highlight "${__BU_MAIN_FS_NAME}")")" 'R';

    # File system max filename length.
    __BU_MAIN_FS_MAX_FILENAME_LENGTH='255';

    BU.ModuleInit.DisplayInitGlobalVarsInfos '__BU_MAIN_FS_MAX_FILENAME_LENGTH' "${__BU_MAIN_FS_MAX_FILENAME_LENGTH}" 'Int' \
        "${__BU_MODULE_INIT_MSG__BU_MAIN_MODCONFIG__FILESYSTEM__SET_GENERAL_SPECIFICATION__FILENAME_LENGTH}" \
        "${__BU_MODULE_INIT_MSG__DISP_INIT_GLOB_VARS_INFO__IS_VAR_DEF_IN_INITIALIZER__MAIN_MODULE_CONF}" \
        "${BASH_SOURCE[0]}" "${FUNCAME[0]}" "$(( LINENO - 2 ))";
fi
